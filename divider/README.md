# ELF Divider

A command-line utility written in Rust to dissect an ELF (Executable and Linkable Format) file into its core components: the ELF Header, the Program Headers, and all `PT_LOAD` segments. Each resulting component is compressed using Gzip and then obfuscated using a simple XOR cipher derived from a user-provided seed.

This tool is useful for **binary analysis**, **malware packing/unpacking research**, and **reverse engineering** workflows where isolating and securely storing ELF components is necessary.

## Features

* **ELF Dissection:** Accurately extracts the ELF Header (`Ehdr`), Program Headers (`Phdrs`), and all `PT_LOAD` segments.
* **Gzip Compression:** Each extracted component is compressed to reduce file size.
* **XOR Obfuscation:** A simple stream cipher based on SHA-256 is used to obfuscate the compressed data, requiring a key (`seed`) for later recovery.

## How it Works

The utility processes the input ELF file and performs the following steps:

1.  **Parsing:** Uses the `goblin` crate (implicitly, through the `ExecuteLinkFile::prase` method) to locate the positions and sizes of the ELF Header, Program Headers, and `PT_LOAD` segments.
2.  **Extraction & Compression:**
    * The raw bytes of the ELF Header are extracted and written to `ehdr.bin`.
    * The raw bytes of the Program Headers are extracted and written to `phdr.bin`.
    * Each `PT_LOAD` segment (based on `p_offset` and `p_filesz`) is extracted and written to a file named after its virtual address (`0x...bin`).
    * **Crucially:** Before writing, the raw component data is compressed using **Gzip**.
3.  **Obfuscation:**
    * The `confuse_data` function is applied to the **compressed** data.
    * A 32-byte XOR key is generated by taking the **SHA-256 hash** of the provided `seed` string.
    * The compressed data is then XORed byte-by-byte with the SHA-256 key, cycling the key every 32 bytes (`data[i] = data[i] ^ key[i % 32]`).
4.  **Writing:** The final compressed and obfuscated data is written to the corresponding output file.

## Usage

### Prerequisites

* Rust toolchain installed.

### Build

```bash
cargo build --release